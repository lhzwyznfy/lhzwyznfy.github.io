<!DOCTYPE html>
<html lang="en"><!--语言是英语//bg#e9eae7-->
<meta charset="utf-8">

<head>
  <link rel="stylesheet" href="./css/stylesaf.css" />
  <link rel="stylesheet" href="./css/styles.css">
  <link rel="stylesheet" href="week/css/weekstyle.css">

  <script src="d3.min.js" charset="utf-8"></script>
  <script src="https://dl.ifanr.cn/hydrogen/sdk/sdk-web-latest.js"></script>
  <script src="d3-tip.js"></script>

  <title>呼吸训练</title>

  <style type="text/css">
  </style>
<!--#5e4b2c-->
</head>


<body class="bodyvis">
  <!--date selector-->
  <header> 
    <div class="dateEmoVis">  <!--date selector-->
      <a href="EmoVis.html" onclick="BacktoEmoVis()"><h1 id="EmoVis">EmoVis</h1><!--&emsp;&emsp;--></a>
    </div>
  </header>

 
  <div class="Allregulation"></div>

  <div class="app-container">
    <button id="startBtn">开始</button>
    <button id="stopBtn" disabled>结束</button>
    <div class="timer" id="timer">00:00:00</div>
    <div id="timerRecords"></div>
    <!--div class="breathing-circle" id="breathingCircle"></div-->
  </div>



  <canvas id="particleCanvas"></canvas>


<script>//呼吸训练
    document.addEventListener('DOMContentLoaded', () => {
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const timerDisplay = document.getElementById('timer');
    const breathingCircle = document.getElementById('breathingCircle');
    let startTime;
    let updatedTime;
    let difference;
    let tInterval;
    let running = false;

    // 开始按钮点击事件
    startBtn.addEventListener('click', () => {
        if(!running){
            startTime = new Date().getTime();
            tInterval = setInterval(getShowTime, 1);
            // 禁用开始按钮，启用结束按钮
            startBtn.disabled = true;
            stopBtn.disabled = false;
            running = true;
        }
    });

    // 结束按钮点击事件
    stopBtn.addEventListener('click', function() {
    clearInterval(tInterval);
    startBtn.disabled = false;
    stopBtn.disabled = true;
    running = false;
    recordTime();
    });

    // 更新时间显示
    function getShowTime(){
        updatedTime = new Date().getTime();
        difference = updatedTime - startTime;

        // 计算时分秒
        var hours = Math.floor((difference % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
        var minutes = Math.floor((difference % (60 * 60 * 1000)) / (60 * 1000));
        var seconds = Math.floor((difference % (60 * 1000)) / 1000);
        
        // 格式化时间显示
        hours = (hours < 10) ? "0" + hours : hours;
        minutes = (minutes < 10) ? "0" + minutes : minutes;
        seconds = (seconds < 10) ? "0" + seconds : seconds;
        timerDisplay.innerHTML = hours + ':' + minutes + ':' + seconds;
    }

    function recordTime() {
        const timerRecordsDiv = document.getElementById('timerRecords');
        const timeNow = new Date();
        const duration = timeNow - startTime; // 计算训练时长
        const durationFormatted = new Date(duration).toISOString().slice(11, 19); // 格式化时长
        timerRecordsDiv.innerHTML += `训练时间: ${durationFormatted}<br/>`; // 添加新记录
    }
});

</script>

<script>//粒子
    document.addEventListener('DOMContentLoaded', function() {
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    
    // 设置 canvas 的大小
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // 生成粒子数组
    let particles = [];
    const particleCount = 50; // 可以根据需要调整粒子数量

    // 粒子构造函数
    function Particle(x, y, directionX, directionY, size, color) {
        this.x = x;
        this.y = y;
        this.directionX = directionX;
        this.directionY = directionY;
        this.size = size;
        this.color = color;
    }

    // 用原型绘制粒子方法
    Particle.prototype.draw = function() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
        ctx.fillStyle = this.color;
        ctx.fill();
    }

    // 更新粒子位置的方法
    Particle.prototype.update = function() {
        if (this.x + this.size > canvas.width || this.x - this.size < 0) {
            this.directionX = -this.directionX;
        }
        if (this.y + this.size > canvas.height || this.y - this.size < 0) {
            this.directionY = -this.directionY;
        }
        this.x += this.directionX;
        this.y += this.directionY;

        this.draw();
    }

    // 创建粒子群
    function init() {
        particles = [];
        for (let i = 0; i < particleCount; i++) {
            let size = Math.random() * 8+2;
            let x = Math.random() * (innerWidth - size * 2);
            let y = Math.random() * (innerHeight - size * 2);
            let directionX = (Math.random() * .4) - .2;
            let directionY = (Math.random() * .4) - .2;
            let color = 'white';

            particles.push(new Particle(x, y, directionX, directionY, size, color));
        }
    }

    // 动画循环
    function animate() {
        requestAnimationFrame(animate);
        ctx.clearRect(0, 0, innerWidth, innerHeight);

        for (let i = 0; i < particles.length; i++) {
            particles[i].update();
        }
    }

    // 调整 canvas 大小时重新初始化
    window.addEventListener('resize', function() {
        canvas.width = innerWidth;
        canvas.height = innerHeight;
        init();
    });

    init();
    animate();
});

//回到主页
function BacktoEmoVis(){
  window.location.href = 'EmoVis.html';
}
//回到主页

</script>


</body>

</html>